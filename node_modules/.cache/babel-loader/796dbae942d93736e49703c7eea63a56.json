{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kenny\\\\Projects\\\\djangotutorials\\\\drf_react_project\\\\react_frontend\\\\blogapi\\\\src\\\\App.js\";\nimport Header from \"./components/content/header\";\nimport Footer from \"./components/content/footer\";\nimport Body from \"./components/content/body\";\nimport { Route, BrowserRouter as Router, Switch, Redirect } from \"react-router-dom\";\nimport React, { Component } from \"react\";\nimport RegisterForm from \"./components/actions/registerForm\";\nimport LoginForm from \"./components/actions/loginForm\";\nimport Logout from \"./components/actions/logout\";\nimport SearchPage from \"./components/content/searchPage\";\nimport CreatePost from \"./components/actions/createPost\";\nimport UserContext from \"./context/userContext\";\nimport DarkContext from \"./context/darkMode\";\nimport apiURL from \"./apiUrl\";\nimport axios from \"axios\";\nimport SearchBar from \"./components/actions/searchBar\";\nimport PostDetailWrapper from \"./components/content/postDetailWrapper\";\nimport NotFoundPage from \"./components/content/notFoundPage\";\nimport UpdatePost from \"./components/actions/updatePost\";\nimport DeletePost from \"./components/actions/deletePost\";\nimport Dashboard from \"./components/content/dashboard\";\nimport axiosInstance from \"./baseAxios\";\nimport AdminPage from \"./components/admin/adminPage\";\nimport ReactTooltip from \"react-tooltip\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currentUser: {\n        name: \"\"\n      },\n      users: [],\n      darkMode: false,\n      showSearchBar: true\n    };\n\n    this.handleLoggedIn = username => {\n      const user = {\n        name: username\n      };\n      this.setState({\n        currentUser: user\n      });\n    };\n\n    this.getAuthorById = pk => {\n      if (pk) {\n        const userName = this.state.users.find(user => user.id === pk) ? this.state.users.find(user => user.id === pk).username : \"Anonymous\";\n        return userName;\n      }\n    };\n\n    this.toggleDarkMode = () => {\n      this.setState({\n        darkMode: !this.state.darkMode\n      });\n      this.makePageDark();\n    };\n\n    this.toggleShowSearchBar = boolInp => {\n      this.setState({\n        showSearchBar: boolInp\n      });\n    };\n\n    this.makePageDark = () => {\n      document.querySelector(\"html\").className = !this.state.darkMode ? \"dark-page-bg\" : \"\";\n      document.querySelector(\"body\").className = !this.state.darkMode ? \"dark-page-bg\" : \"\";\n    };\n  }\n\n  componentDidMount() {\n    console.log(axiosInstance.defaults.headers[\"Authorization\"]);\n    const refreshToken = localStorage.getItem(\"refresh_token\");\n\n    if (refreshToken === \"undefined\" || refreshToken === null) {\n      localStorage.removeItem(\"currentUser\");\n    }\n\n    axios.get(apiURL + \"user/list/\").then(res => this.setState({\n      users: res.data\n    }));\n\n    if (18.5 < new Date().getHours() || new Date().getHours() < 7) {\n      console.log(\"Going Dark\");\n      this.setState({\n        darkMode: true\n      });\n      this.makePageDark();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(DarkContext.Provider, {\n      value: {\n        darkMode: this.state.darkMode,\n        toggleDarkMode: this.toggleDarkMode,\n        background: \"dark-bg\"\n      },\n      children: /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n        value: {\n          currentUser: this.state.currentUser,\n          onLogIn: this.handleLoggedIn,\n          getAuthor: this.getAuthorById\n        },\n        children: /*#__PURE__*/_jsxDEV(Router, {\n          children: [/*#__PURE__*/_jsxDEV(ReactTooltip, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this), this.state.showSearchBar ? /*#__PURE__*/_jsxDEV(SearchBar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 41\n          }, this) : \"\", /*#__PURE__*/_jsxDEV(Switch, {\n            children: [/*#__PURE__*/_jsxDEV(PrivateAdminRoute, {\n              path: \"/admin\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              users: this.state.users,\n              component: AdminPage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/search\",\n              component: SearchPage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/posts/:slug\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              component: PostDetailWrapper\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/update-post/:slug\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              users: this.state.users,\n              component: UpdatePost\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/delete-post/:slug\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              users: this.state.users,\n              component: DeletePost\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/create-post\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              users: this.state.users,\n              component: CreatePost\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              path: \"/login\",\n              render: props => /*#__PURE__*/_jsxDEV(LoginForm, {\n                toggleShowSearchBar: this.toggleShowSearchBar,\n                ...props\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              path: \"/register\",\n              render: props => /*#__PURE__*/_jsxDEV(RegisterForm, {\n                toggleShowSearchBar: this.toggleShowSearchBar,\n                ...props\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              path: \"/logout\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              component: Logout\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              exact: true,\n              path: \"/dashboard\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              component: Dashboard\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(IsAuthenticatedRoute, {\n              exact: true,\n              path: \"/\",\n              toggleShowSearchBar: this.toggleShowSearchBar,\n              component: Body\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              path: \"*\",\n              children: /*#__PURE__*/_jsxDEV(NotFoundPage, {\n                toggleShowSearchBar: this.toggleShowSearchBar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst IsAuthenticatedRoute = ({\n  component: Component,\n  toggleShowSearchBar,\n  users,\n  ...rest\n}) => {\n  // Add your own authentication on the below line.\n  const refreshToken = localStorage.getItem(\"refresh_token\") === \"undefined\" || localStorage.getItem(\"refresh_token\") === null ? false : true;\n  return /*#__PURE__*/_jsxDEV(Route, { ...rest,\n    render: props => refreshToken ? /*#__PURE__*/_jsxDEV(Component, { ...props,\n      users: users,\n      toggleShowSearchBar: toggleShowSearchBar\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n      to: {\n        pathname: \"/login\",\n        state: {\n          from: props.location\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 206,\n    columnNumber: 5\n  }, this);\n};\n\n_c = IsAuthenticatedRoute;\n\nconst PrivateAdminRoute = ({\n  component: Component,\n  toggleShowSearchBar,\n  users,\n  ...rest\n}) => {\n  // Add your own authentication on the below line.\n  const refreshToken = localStorage.getItem(\"refresh_token\") === \"undefined\" || localStorage.getItem(\"refresh_token\") === null ? false : true;\n  const accessToken = localStorage.getItem(\"access_token\");\n  if (!accessToken) return /*#__PURE__*/_jsxDEV(Redirect, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 240,\n    columnNumber: 28\n  }, this);\n  const currentUserId = JSON.parse(atob(accessToken.split(\".\")[1])).user_id;\n  const user = users.filter(user => user.id === currentUserId)[0];\n\n  if (user) {\n    return /*#__PURE__*/_jsxDEV(Route, { ...rest,\n      render: props => refreshToken && user.is_superuser ? /*#__PURE__*/_jsxDEV(Component, { ...props,\n        users: users,\n        toggleShowSearchBar: toggleShowSearchBar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(Redirect, {\n        to: {\n          pathname: \"/not-allowed\",\n          state: {\n            from: props.location\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this);\n  }\n\n  return null;\n};\n\n_c2 = PrivateAdminRoute;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"IsAuthenticatedRoute\");\n$RefreshReg$(_c2, \"PrivateAdminRoute\");","map":{"version":3,"sources":["C:/Users/kenny/Projects/djangotutorials/drf_react_project/react_frontend/blogapi/src/App.js"],"names":["Header","Footer","Body","Route","BrowserRouter","Router","Switch","Redirect","React","Component","RegisterForm","LoginForm","Logout","SearchPage","CreatePost","UserContext","DarkContext","apiURL","axios","SearchBar","PostDetailWrapper","NotFoundPage","UpdatePost","DeletePost","Dashboard","axiosInstance","AdminPage","ReactTooltip","App","state","currentUser","name","users","darkMode","showSearchBar","handleLoggedIn","username","user","setState","getAuthorById","pk","userName","find","id","toggleDarkMode","makePageDark","toggleShowSearchBar","boolInp","document","querySelector","className","componentDidMount","console","log","defaults","headers","refreshToken","localStorage","getItem","removeItem","get","then","res","data","Date","getHours","render","background","onLogIn","getAuthor","props","IsAuthenticatedRoute","component","rest","pathname","from","location","PrivateAdminRoute","accessToken","currentUserId","JSON","parse","atob","split","user_id","filter","is_superuser"],"mappings":"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","sourcesContent":["import Header from \"./components/content/header\";\r\nimport Footer from \"./components/content/footer\";\r\nimport Body from \"./components/content/body\";\r\nimport {\r\n  Route,\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Redirect,\r\n} from \"react-router-dom\";\r\n\r\nimport React, { Component } from \"react\";\r\nimport RegisterForm from \"./components/actions/registerForm\";\r\nimport LoginForm from \"./components/actions/loginForm\";\r\nimport Logout from \"./components/actions/logout\";\r\nimport SearchPage from \"./components/content/searchPage\";\r\nimport CreatePost from \"./components/actions/createPost\";\r\n\r\nimport UserContext from \"./context/userContext\";\r\nimport DarkContext from \"./context/darkMode\";\r\n\r\nimport apiURL from \"./apiUrl\";\r\nimport axios from \"axios\";\r\nimport SearchBar from \"./components/actions/searchBar\";\r\nimport PostDetailWrapper from \"./components/content/postDetailWrapper\";\r\nimport NotFoundPage from \"./components/content/notFoundPage\";\r\nimport UpdatePost from \"./components/actions/updatePost\";\r\nimport DeletePost from \"./components/actions/deletePost\";\r\nimport Dashboard from \"./components/content/dashboard\";\r\nimport axiosInstance from \"./baseAxios\";\r\nimport AdminPage from \"./components/admin/adminPage\";\r\nimport ReactTooltip from \"react-tooltip\";\r\n\r\nexport default class App extends Component {\r\n  state = {\r\n    currentUser: { name: \"\" },\r\n    users: [],\r\n    darkMode: false,\r\n    showSearchBar: true,\r\n  };\r\n\r\n  handleLoggedIn = (username) => {\r\n    const user = { name: username };\r\n    this.setState({ currentUser: user });\r\n  };\r\n\r\n  componentDidMount() {\r\n    console.log(axiosInstance.defaults.headers[\"Authorization\"]);\r\n    const refreshToken = localStorage.getItem(\"refresh_token\");\r\n    if (refreshToken === \"undefined\" || refreshToken === null) {\r\n      localStorage.removeItem(\"currentUser\");\r\n    }\r\n\r\n    axios\r\n      .get(apiURL + \"user/list/\")\r\n      .then((res) => this.setState({ users: res.data }));\r\n\r\n    if (18.5 < new Date().getHours() || new Date().getHours() < 7) {\r\n      console.log(\"Going Dark\");\r\n      this.setState({ darkMode: true });\r\n      this.makePageDark();\r\n    }\r\n  }\r\n\r\n  getAuthorById = (pk) => {\r\n    if (pk) {\r\n      const userName = this.state.users.find((user) => user.id === pk)\r\n        ? this.state.users.find((user) => user.id === pk).username\r\n        : \"Anonymous\";\r\n      return userName;\r\n    }\r\n  };\r\n\r\n  toggleDarkMode = () => {\r\n    this.setState({ darkMode: !this.state.darkMode });\r\n    this.makePageDark();\r\n  };\r\n\r\n  toggleShowSearchBar = (boolInp) => {\r\n    this.setState({ showSearchBar: boolInp });\r\n  };\r\n\r\n  makePageDark = () => {\r\n    document.querySelector(\"html\").className = !this.state.darkMode\r\n      ? \"dark-page-bg\"\r\n      : \"\";\r\n\r\n    document.querySelector(\"body\").className = !this.state.darkMode\r\n      ? \"dark-page-bg\"\r\n      : \"\";\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DarkContext.Provider\r\n        value={{\r\n          darkMode: this.state.darkMode,\r\n          toggleDarkMode: this.toggleDarkMode,\r\n          background: \"dark-bg\",\r\n        }}\r\n      >\r\n        <UserContext.Provider\r\n          value={{\r\n            currentUser: this.state.currentUser,\r\n            onLogIn: this.handleLoggedIn,\r\n            getAuthor: this.getAuthorById,\r\n          }}\r\n        >\r\n          <Router>\r\n            <ReactTooltip />\r\n            <Header />\r\n            {this.state.showSearchBar ? <SearchBar /> : \"\"}\r\n            <Switch>\r\n              <PrivateAdminRoute\r\n                path=\"/admin\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                users={this.state.users}\r\n                component={AdminPage}\r\n              />\r\n\r\n              <IsAuthenticatedRoute path=\"/search\" component={SearchPage} />\r\n              <IsAuthenticatedRoute\r\n                path=\"/posts/:slug\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                component={PostDetailWrapper}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                path=\"/update-post/:slug\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                users={this.state.users}\r\n                component={UpdatePost}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                path=\"/delete-post/:slug\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                users={this.state.users}\r\n                component={DeletePost}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                path=\"/create-post\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                users={this.state.users}\r\n                component={CreatePost}\r\n              />\r\n              <Route\r\n                path=\"/login\"\r\n                render={(props) => (\r\n                  <LoginForm\r\n                    toggleShowSearchBar={this.toggleShowSearchBar}\r\n                    {...props}\r\n                  />\r\n                )}\r\n              />\r\n              <Route\r\n                path=\"/register\"\r\n                render={(props) => (\r\n                  <RegisterForm\r\n                    toggleShowSearchBar={this.toggleShowSearchBar}\r\n                    {...props}\r\n                  />\r\n                )}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                path=\"/logout\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                component={Logout}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                exact\r\n                path=\"/dashboard\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                component={Dashboard}\r\n              />\r\n              <IsAuthenticatedRoute\r\n                exact\r\n                path=\"/\"\r\n                toggleShowSearchBar={this.toggleShowSearchBar}\r\n                component={Body}\r\n              />\r\n              <Route path=\"*\">\r\n                <NotFoundPage toggleShowSearchBar={this.toggleShowSearchBar} />\r\n              </Route>\r\n            </Switch>\r\n            <Footer />\r\n          </Router>\r\n        </UserContext.Provider>\r\n      </DarkContext.Provider>\r\n    );\r\n  }\r\n}\r\n\r\nconst IsAuthenticatedRoute = ({\r\n  component: Component,\r\n  toggleShowSearchBar,\r\n  users,\r\n  ...rest\r\n}) => {\r\n  // Add your own authentication on the below line.\r\n\r\n  const refreshToken =\r\n    localStorage.getItem(\"refresh_token\") === \"undefined\" ||\r\n    localStorage.getItem(\"refresh_token\") === null\r\n      ? false\r\n      : true;\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) =>\r\n        refreshToken ? (\r\n          <Component\r\n            {...props}\r\n            users={users}\r\n            toggleShowSearchBar={toggleShowSearchBar}\r\n          />\r\n        ) : (\r\n          <Redirect\r\n            to={{ pathname: \"/login\", state: { from: props.location } }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n};\r\n\r\nconst PrivateAdminRoute = ({\r\n  component: Component,\r\n  toggleShowSearchBar,\r\n  users,\r\n  ...rest\r\n}) => {\r\n  // Add your own authentication on the below line.\r\n\r\n  const refreshToken =\r\n    localStorage.getItem(\"refresh_token\") === \"undefined\" ||\r\n    localStorage.getItem(\"refresh_token\") === null\r\n      ? false\r\n      : true;\r\n  const accessToken = localStorage.getItem(\"access_token\");\r\n\r\n  if (!accessToken) return <Redirect to={\"/\"} />;\r\n\r\n  const currentUserId = JSON.parse(atob(accessToken.split(\".\")[1])).user_id;\r\n\r\n  const user = users.filter((user) => user.id === currentUserId)[0];\r\n\r\n  if (user) {\r\n    return (\r\n      <Route\r\n        {...rest}\r\n        render={(props) =>\r\n          refreshToken && user.is_superuser ? (\r\n            <Component\r\n              {...props}\r\n              users={users}\r\n              toggleShowSearchBar={toggleShowSearchBar}\r\n            />\r\n          ) : (\r\n            <Redirect\r\n              to={{ pathname: \"/not-allowed\", state: { from: props.location } }}\r\n            />\r\n          )\r\n        }\r\n      />\r\n    );\r\n  }\r\n  return null;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}