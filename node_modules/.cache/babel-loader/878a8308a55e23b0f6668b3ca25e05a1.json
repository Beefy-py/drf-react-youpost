{"ast":null,"code":"import _classCallCheck from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import Form from\"../common/form\";import Joi from\"joi-browser\";import DarkContext from\"../../context/darkMode\";import axios from\"axios\";import apiURL from\"../../apiUrl\";import axiosInstance from\"./../../baseAxios\";import{Link}from\"react-router-dom\";import history from\"./../../history\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdatePost=/*#__PURE__*/function(_Form){_inherits(UpdatePost,_Form);var _super=_createSuper(UpdatePost);function UpdatePost(){var _this;_classCallCheck(this,UpdatePost);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{title:\"\",content:\"\"},errors:{},slug:\"\"};_this.schema={title:Joi.string().required().min(10).max(80).label(\"Title\"),image:Joi.any().meta({swaggerType:\"file\"}).optional().description(\"Image File\"),content:Joi.string().required().min(100).label(\"Content\")};_this.afterSubmit=function(){var _this$state$data=_this.state.data,title=_this$state$data.title,content=_this$state$data.content;var formData=new FormData();if(!_this.chosenImg){_this.chosenImg=\"\";}console.log(_this.chosenImg);var imgName=_this.chosenImg?_this.chosenImg.name:\"\";formData.append(\"image\",_this.chosenImg);formData.append(\"title\",title);formData.append(\"slug\",\"\");formData.append(\"content\",content);formData.append(\"author\",_this.props.users.filter(function(user){return user.username==localStorage.getItem(\"currentUser\");})[0].id);axiosInstance.put(\"update-post/\"+_this.props.match.params.slug,formData).then(function(res){_this.props.history.replace(\"/dashboard\");console.log(res);}).catch(function(response){return console.log(response.response);});};return _this;}_createClass(UpdatePost,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.props.toggleShowSearchBar(false);axiosInstance.get(apiURL+\"posts/\"+this.props.match.params.slug).then(function(res){var _res$data=res.data,title=_res$data.title,slug=_res$data.slug,content=_res$data.content;_this2.setState({slug:slug});_this2.setState({data:{title:title,content:content}});}).catch(function(res){return console.log(res.response);});var BaseJoi=require(\"joi-browser\");var ImageExtension=require(\"joi-image-extension\");var Joi=BaseJoi.extend(ImageExtension);this.setState({joi:Joi});}},{key:\"afterChange\",value:function afterChange(input){}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsx(DarkContext.Consumer,{children:function children(darkContext){return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container border \"+\"\".concat(darkContext.darkMode?\"bg-dark\":\"bg-light\"),children:[/*#__PURE__*/_jsx(\"h1\",{className:darkContext.darkMode?\"text-light\":\"\",children:\"Updating Your Post..\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:_this3.handleSubmit,children:[_this3.renderInput(\"title\",\"Title\"),_this3.renderImageField(\"image\",\"Choose Image Again\",\"image/*\"),_this3.renderTextArea(\"content\",\"Content\"),/*#__PURE__*/_jsxs(\"div\",{className:\"update-cancel-post-container\",children:[_this3.renderButton(\"Update Post\"),/*#__PURE__*/_jsx(Link//to={\"/posts/\" + this.state.slug}\n,{onClick:history.goBack,className:\"btn btn-primary\",children:\"Cancel\"})]})]})]});}});}}]);return UpdatePost;}(Form);export{UpdatePost as default};","map":{"version":3,"sources":["C:/Users/kenny/Projects/drf_react_youpost/src/components/actions/updatePost.jsx"],"names":["React","Form","Joi","DarkContext","axios","apiURL","axiosInstance","Link","history","UpdatePost","state","data","title","content","errors","slug","schema","string","required","min","max","label","image","any","meta","swaggerType","optional","description","afterSubmit","formData","FormData","chosenImg","console","log","imgName","name","append","props","users","filter","user","username","localStorage","getItem","id","put","match","params","then","res","replace","catch","response","toggleShowSearchBar","get","setState","BaseJoi","require","ImageExtension","extend","joi","input","darkContext","darkMode","handleSubmit","renderInput","renderImageField","renderTextArea","renderButton","goBack"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Form from \"../common/form\";\r\nimport Joi from \"joi-browser\";\r\nimport DarkContext from \"../../context/darkMode\";\r\nimport axios from \"axios\";\r\nimport apiURL from \"../../apiUrl\";\r\nimport axiosInstance from \"./../../baseAxios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport history from \"./../../history\";\r\n\r\nexport default class UpdatePost extends Form {\r\n  componentDidMount() {\r\n    this.props.toggleShowSearchBar(false);\r\n    axiosInstance\r\n      .get(apiURL + \"posts/\" + this.props.match.params.slug)\r\n      .then((res) => {\r\n        const { title, slug, content } = res.data;\r\n        this.setState({ slug: slug });\r\n\r\n        this.setState({\r\n          data: {\r\n            title: title,\r\n\r\n            content: content,\r\n          },\r\n        });\r\n      })\r\n      .catch((res) => console.log(res.response));\r\n\r\n    const BaseJoi = require(\"joi-browser\");\r\n    const ImageExtension = require(\"joi-image-extension\");\r\n\r\n    const Joi = BaseJoi.extend(ImageExtension);\r\n    this.setState({ joi: Joi });\r\n  }\r\n\r\n  state = {\r\n    data: { title: \"\", content: \"\" },\r\n    errors: {},\r\n    slug: \"\",\r\n  };\r\n\r\n  schema = {\r\n    title: Joi.string().required().min(10).max(80).label(\"Title\"),\r\n    image: Joi.any()\r\n      .meta({ swaggerType: \"file\" })\r\n      .optional()\r\n      .description(\"Image File\"),\r\n    content: Joi.string().required().min(100).label(\"Content\"),\r\n  };\r\n\r\n  afterSubmit = () => {\r\n    const { title, content } = this.state.data;\r\n\r\n    let formData = new FormData();\r\n\r\n    if (!this.chosenImg) {\r\n      this.chosenImg = \"\";\r\n    }\r\n\r\n    console.log(this.chosenImg);\r\n    const imgName = this.chosenImg ? this.chosenImg.name : \"\";\r\n\r\n    formData.append(\"image\", this.chosenImg);\r\n    formData.append(\"title\", title);\r\n    formData.append(\"slug\", \"\");\r\n    formData.append(\"content\", content);\r\n    formData.append(\r\n      \"author\",\r\n      this.props.users.filter(\r\n        (user) => user.username == localStorage.getItem(\"currentUser\")\r\n      )[0].id\r\n    );\r\n\r\n    axiosInstance\r\n      .put(\"update-post/\" + this.props.match.params.slug, formData)\r\n      .then((res) => {\r\n        this.props.history.replace(\"/dashboard\");\r\n        console.log(res);\r\n      })\r\n      .catch((response) => console.log(response.response));\r\n  };\r\n\r\n  afterChange(input) {}\r\n\r\n  render() {\r\n    return (\r\n      <DarkContext.Consumer>\r\n        {(darkContext) => (\r\n          <div\r\n            className={\r\n              \"form-container border \" +\r\n              `${darkContext.darkMode ? \"bg-dark\" : \"bg-light\"}`\r\n            }\r\n          >\r\n            <h1 className={darkContext.darkMode ? \"text-light\" : \"\"}>\r\n              Updating Your Post..\r\n            </h1>\r\n            <form action=\"\" onSubmit={this.handleSubmit}>\r\n              {this.renderInput(\"title\", \"Title\")}\r\n              {this.renderImageField(\"image\", \"Choose Image Again\", \"image/*\")}\r\n              {this.renderTextArea(\"content\", \"Content\")}\r\n              <div className=\"update-cancel-post-container\">\r\n                {this.renderButton(\"Update Post\")}\r\n                <Link\r\n                  //to={\"/posts/\" + this.state.slug}\r\n                  onClick={history.goBack}\r\n                  className=\"btn btn-primary\"\r\n                >\r\n                  Cancel\r\n                </Link>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )}\r\n      </DarkContext.Consumer>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}