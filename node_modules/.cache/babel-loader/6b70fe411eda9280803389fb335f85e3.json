{"ast":null,"code":"import _objectSpread from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import Form from\"../common/form\";import Joi from\"joi-browser\";// import Joi from \"./../../utils/extendedJoi\";\nimport DarkContext from\"../../context/darkMode\";import axiosInstance from\"./../../baseAxios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreatePost=/*#__PURE__*/function(_Form){_inherits(CreatePost,_Form);var _super=_createSuper(CreatePost);function CreatePost(){var _this;_classCallCheck(this,CreatePost);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{title:\"\",image:\"\",content:\"\"},errors:{},slugs:[],joi:\"\"};_this.schema={title:Joi.string().required().min(10).max(80).label(\"Title\"),image:_this.state.joi?_this.state.joi.image().label(\"Image\"):Joi.string().label(\"Image\"),// image: Joi.image().label(\"Image\"),\ncontent:Joi.string().required().min(100).label(\"Content\")};_this.afterSubmit=function(){var _this$state$data=_this.state.data,title=_this$state$data.title,content=_this$state$data.content;var formData=new FormData();formData.append(\"image\",_this.chosenImg,_this.chosenImg.name);formData.append(\"title\",title);formData.append(\"content\",content);formData.append(\"author\",_this.props.users.filter(function(user){return user.username==localStorage.getItem(\"currentUser\");})[0].id);axiosInstance.post(\"create-post/\",formData,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(function(res){_this.props.history.replace(\"/dashboard\");console.log(res);}).catch(function(res){var errorTitle=res.response.data.title?res.response.data.title[0]:\"\";var errors400=_objectSpread(_objectSpread({},_this.state.errors),{},{title:errorTitle});_this.setState({errors:errors400});});};return _this;}_createClass(CreatePost,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.props.toggleShowSearchBar(false);axiosInstance.get().then(function(res){var slugs=res.data.map(function(post){return post.slug;});_this2.setState({slugs:slugs});});var BaseJoi=require(\"joi-browser\");var ImageExtension=require(\"joi-image-extension\");var Joi=BaseJoi.extend(ImageExtension);this.setState({joi:Joi});}},{key:\"afterChange\",value:function afterChange(inp){}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsx(DarkContext.Consumer,{children:function children(darkContext){return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container border \"+\"\".concat(darkContext.darkMode?\"bg-dark\":\"bg-light\"),children:[/*#__PURE__*/_jsx(\"h1\",{className:darkContext.darkMode?\"text-light\":\"\",children:\"Create A Post\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:_this3.handleSubmit,children:[_this3.renderInput(\"title\",\"Title\"),_this3.renderImageField(\"image\",\"Image\",\"image/*\"),_this3.renderTextArea(\"content\",\"Content\"),_this3.renderButton(\"Post\")]})]});}});}}]);return CreatePost;}(Form);export{CreatePost as default};","map":{"version":3,"sources":["C:/Users/kenny/Projects/drf_react_youpost/src/components/actions/createPost.jsx"],"names":["React","Form","Joi","DarkContext","axiosInstance","CreatePost","state","data","title","image","content","errors","slugs","joi","schema","string","required","min","max","label","afterSubmit","formData","FormData","append","chosenImg","name","props","users","filter","user","username","localStorage","getItem","id","post","headers","then","res","history","replace","console","log","catch","errorTitle","response","errors400","setState","toggleShowSearchBar","get","map","slug","BaseJoi","require","ImageExtension","extend","inp","darkContext","darkMode","handleSubmit","renderInput","renderImageField","renderTextArea","renderButton"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Form from \"../common/form\";\r\nimport Joi from \"joi-browser\";\r\n// import Joi from \"./../../utils/extendedJoi\";\r\nimport DarkContext from \"../../context/darkMode\";\r\nimport axiosInstance from \"./../../baseAxios\";\r\n\r\nexport default class CreatePost extends Form {\r\n  componentDidMount() {\r\n    this.props.toggleShowSearchBar(false);\r\n    axiosInstance.get().then((res) => {\r\n      const slugs = res.data.map((post) => post.slug);\r\n      this.setState({ slugs: slugs });\r\n    });\r\n\r\n    const BaseJoi = require(\"joi-browser\");\r\n    const ImageExtension = require(\"joi-image-extension\");\r\n\r\n    const Joi = BaseJoi.extend(ImageExtension);\r\n    this.setState({ joi: Joi });\r\n  }\r\n\r\n  state = {\r\n    data: { title: \"\", image: \"\", content: \"\" },\r\n    errors: {},\r\n    slugs: [],\r\n    joi: \"\",\r\n  };\r\n\r\n  schema = {\r\n    title: Joi.string().required().min(10).max(80).label(\"Title\"),\r\n    image: this.state.joi\r\n      ? this.state.joi.image().label(\"Image\")\r\n      : Joi.string().label(\"Image\"),\r\n    // image: Joi.image().label(\"Image\"),\r\n    content: Joi.string().required().min(100).label(\"Content\"),\r\n  };\r\n\r\n  afterSubmit = () => {\r\n    const { title, content } = this.state.data;\r\n\r\n    let formData = new FormData();\r\n\r\n    formData.append(\"image\", this.chosenImg, this.chosenImg.name);\r\n    formData.append(\"title\", title);\r\n    formData.append(\"content\", content);\r\n    formData.append(\r\n      \"author\",\r\n      this.props.users.filter(\r\n        (user) => user.username == localStorage.getItem(\"currentUser\")\r\n      )[0].id\r\n    );\r\n\r\n    axiosInstance\r\n      .post(\"create-post/\", formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      })\r\n      .then((res) => {\r\n        this.props.history.replace(\"/dashboard\");\r\n        console.log(res);\r\n      })\r\n      .catch((res) => {\r\n        const errorTitle = res.response.data.title\r\n          ? res.response.data.title[0]\r\n          : \"\";\r\n\r\n        const errors400 = { ...this.state.errors, title: errorTitle };\r\n        this.setState({ errors: errors400 });\r\n      });\r\n  };\r\n\r\n  afterChange(inp) {}\r\n\r\n  render() {\r\n    return (\r\n      <DarkContext.Consumer>\r\n        {(darkContext) => (\r\n          <div\r\n            className={\r\n              \"form-container border \" +\r\n              `${darkContext.darkMode ? \"bg-dark\" : \"bg-light\"}`\r\n            }\r\n          >\r\n            <h1 className={darkContext.darkMode ? \"text-light\" : \"\"}>\r\n              Create A Post\r\n            </h1>\r\n            <form action=\"\" onSubmit={this.handleSubmit}>\r\n              {this.renderInput(\"title\", \"Title\")}\r\n              {this.renderImageField(\"image\", \"Image\", \"image/*\")}\r\n              {this.renderTextArea(\"content\", \"Content\")}\r\n              {this.renderButton(\"Post\")}\r\n            </form>\r\n          </div>\r\n        )}\r\n      </DarkContext.Consumer>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}