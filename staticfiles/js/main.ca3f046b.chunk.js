(this.webpackJsonpblogapi=this.webpackJsonpblogapi||[]).push([[0],{54:function(e,t,a){},98:function(e,t,a){"use strict";a.r(t);var s=a(1),r=a.n(s),n=a(44),o=a.n(n),c=(a(53),a(54),a(19)),i=a(8),l=a(4),d=a(5),u=a(7),h=a(6),b=a(2),j=Object(s.createContext)();j.displayName="UserContext";var m=j,g=r.a.createContext();g.displayName="darkContext";var p=g,f=a(0),O=function(){Object(s.useContext)(m);var e=Object(s.useContext)(p),t=localStorage.getItem("refresh_token"),a=(localStorage.getItem("access_token"),"undefined"!==t&&null!==t),n=e.darkMode?"dropdown-item bg-dark text-light":"dropdown-item bg-light";return Object(f.jsx)("nav",{className:e.darkMode?"navbar-dark bg-dark navbar navbar-expand-lg dark-page-shadow":"navbar-light bg-light navbar navbar-expand-lg border",children:Object(f.jsxs)("div",{className:"container-fluid",children:[Object(f.jsx)(b.c,{className:"navbar-brand text-success",to:"/",children:Object(f.jsx)("b",{children:"YouPost"})}),Object(f.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(f.jsx)("span",{className:"navbar-toggler-icon"})}),Object(f.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(f.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(b.c,{className:"nav-link active",to:"/dashboard",children:"Dashboard"})}),Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(b.c,{className:"nav-link active",to:"/",children:"Posts"})}),Object(f.jsxs)("li",{className:"nav-item dropdown",children:[Object(f.jsxs)(b.c,{className:"nav-link dropdown-toggle",to:"/",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[Object(f.jsx)("i",{className:"fas fa-user-circle"}),a?localStorage.getItem("currentUser"):"Guest"]}),Object(f.jsxs)("ul",{className:e.darkMode?"dropdown-menu bg-dark border":"dropdown-menu bg-light","aria-labelledby":"navbarDropdown",children:[a?Object(f.jsx)("li",{children:Object(f.jsxs)(b.c,{className:n,to:"/logout",children:[Object(f.jsx)("i",{className:"fas fa-sign-out-alt"})," Logout"]})}):Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)("li",{children:Object(f.jsxs)(b.c,{className:n,to:"/login",children:[Object(f.jsx)("i",{className:"fas fa-sign-in-alt"})," Login"]})}),Object(f.jsx)("li",{children:Object(f.jsxs)(b.c,{className:n,to:"/register",children:[Object(f.jsx)("i",{className:"fas fa-user-plus"})," Register"]})})]}),Object(f.jsx)("li",{children:Object(f.jsx)("hr",{className:"dropdown-divider"})}),Object(f.jsx)("li",{children:Object(f.jsxs)(b.c,{className:n,to:"/",children:[Object(f.jsx)("i",{className:"fas fa-user-cog"})," Settings"]})}),Object(f.jsx)("li",{className:n+" dark-mode-toggler",onClick:e.toggleDarkMode,children:e.darkMode?Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)("i",{className:"fas fa-sun"}),Object(f.jsx)("span",{children:"Light"})]}):Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)("i",{className:"fas fa-moon"}),Object(f.jsx)("span",{children:"Dark"})]})})]})]})]})})]})})},x=function(){var e=Object(s.useContext)(p);return Object(f.jsxs)("footer",{className:e.darkMode?"text-center text-lg-start bg-dark text-muted dark-page-shadow footer-dark":"text-center text-lg-start bg-light text-muted",children:[Object(f.jsxs)("section",{className:"d-flex justify-content-center justify-content-lg-between p-4 border-bottom",children:[Object(f.jsx)("div",{className:"me-5 d-none d-lg-block",children:Object(f.jsx)("span",{children:"Get connected with us on social networks:"})}),Object(f.jsxs)("div",{children:[Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-facebook-f"})}),Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-twitter"})}),Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-google"})}),Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-instagram"})}),Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-linkedin"})}),Object(f.jsx)("a",{href:"#",className:"me-4 text-reset",children:Object(f.jsx)("i",{className:"fab fa-github"})})]})]}),Object(f.jsx)("section",{className:"",children:Object(f.jsx)("div",{className:"container text-center text-md-start mt-5",children:Object(f.jsxs)("div",{className:"row mt-3",children:[Object(f.jsxs)("div",{className:"col-md-3 col-lg-4 col-xl-3 mx-auto mb-4",children:[Object(f.jsxs)("h6",{className:"text-uppercase fw-bold mb-4",children:[Object(f.jsx)("i",{className:"fas fa-gem me-3"}),"Company name"]}),Object(f.jsx)("p",{children:"Here you can use rows and columns to organize your footer content. Lorem ipsum dolor sit amet, consectetur adipisicing elit."})]}),Object(f.jsxs)("div",{className:"col-md-2 col-lg-2 col-xl-2 mx-auto mb-4",children:[Object(f.jsx)("h6",{className:"text-uppercase fw-bold mb-4",children:"Products"}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Angular"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"React"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Vue"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Laravel"})})]}),Object(f.jsxs)("div",{className:"col-md-3 col-lg-2 col-xl-2 mx-auto mb-4",children:[Object(f.jsx)("h6",{className:"text-uppercase fw-bold mb-4",children:"Useful links"}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Pricing"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Settings"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Orders"})}),Object(f.jsx)("p",{children:Object(f.jsx)("a",{href:"#",className:"text-reset",children:"Help"})})]}),Object(f.jsxs)("div",{className:"col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4",children:[Object(f.jsx)("h6",{className:"text-uppercase fw-bold mb-4",children:"Contact"}),Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-home me-3"})," New York, NY 10012, US"]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-envelope me-3"}),"info@example.com"]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-phone me-3"})," + 01 234 567 88"]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-print me-3"})," + 01 234 567 89"]})]})]})})}),Object(f.jsxs)("div",{className:"text-center p-4",children:["\xa9 2021 Copyright:",Object(f.jsx)("a",{className:"text-reset fw-bold",href:"https://mdbootstrap.com/",children:"MDBootstrap.com"})]})]})},v=a(17),k=a(18),S=a(21),N=a.n(S),w=a(22),y=a(30),C=a.n(y),I=a(46),B=a(12),M=a.n(B);M.a.defaults.xsrfCookieName="csrftoken",M.a.defaults.xsrfHeaderName="X-CSRFToken";var D="http://localhost:8000/api/",P=M.a.create({baseURL:D,timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT "+localStorage.getItem("access_token"):null,"Content-Type":"application/json",accept:"application/json"}});P.interceptors.response.use((function(e){return e}),function(){var e=Object(I.a)(C.a.mark((function e(t){var a,s,r,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.config,"undefined"!==typeof t.response){e.next=4;break}return alert("A server/network error occurred. Looks like CORS might be the problem. Sorry about this - we will get it fixed shortly."),e.abrupt("return",Promise.reject(t));case 4:if(401!==t.response.status||a.url!==D+"token/refresh/"){e.next=7;break}return window.location.href="/login/",e.abrupt("return",Promise.reject(t));case 7:if("token_not_valid"!==t.response.data.code||401!==t.response.status||"Unauthorized"!==t.response.statusText){e.next=23;break}if("undefined"===(s=localStorage.getItem("refresh_token"))){e.next=21;break}if(null===s&&window.location.reload(),r=JSON.parse(atob(s.split(".")[1])),n=Math.ceil(Date.now()/1e3),!(r.exp>n)){e.next=17;break}return e.abrupt("return",P.post("/token/refresh",{refresh:s}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),P.defaults.headers.Authorization="JWT "+e.data.access,a.headers.Authorization="JWT "+e.data.access,P(a)})));case 17:console.log("Refresh token is expired",r.exp,n),window.location.href="/login/";case 19:e.next=23;break;case 21:window.location.href="/login/",console.log("Refresh token not available.");case 23:return e.abrupt("return",Promise.reject(t));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var U=P,A=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={rating:0,users:[],currentUserId:JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id,currentUser:{},likeClass:"btn btn-outline-dark",dislikeClass:"btn btn-outline-dark",bookmarkClass:"btn btn-outline-dark",bookmarkDataTip:"add to bookmarks"},e.addBookmark=function(t){var a,s=e.state,r=s.currentUser,n=s.currentUserId;a=r.bookmarked,console.log("\n before",r.bookmarked),r.bookmarked.includes(t.id)?(a.splice(a.indexOf(t.id),1),e.setState({bookmarkClass:"btn btn-outline-dark"}),e.setState({bookmarkDataTip:"add to bookmarks"})):(a.push(t.id),e.setState({bookmarkClass:"btn btn-info"}),e.setState({bookmarkDataTip:"remove from bookmarks"})),r.bookmarked=a,console.log("\n after",r.bookmarked),U.put("user/list/"+n,Object(i.a)(Object(i.a)({},r),{},{bookmarked:a})),window.location.replace("/dashboard")},e.getRatingColor=function(e){var t="rate badge ";return e>999999999?t+"rate1b":e>999999?t+"rate1m":e>99999?t+"rate100k":e>999?t+"rate1k":e>0?t+"before1k":0===e?t+"rate0":e<-999999999?t+"rate-1b":e<-999999?t+"rate-1m":e<-99999?t+"rate-100k":e<-999?t+"rate-1k":e<0?t+"before-1k":t+"badge-primary"},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;U.get("user/list/").then((function(t){e.setState({users:t.data})})),U.get("posts/"+this.props.post.slug).then((function(t){return e.setState({rating:t.data.rating})})),U.get("user/list/"+this.state.currentUserId).then((function(t){e.setState({currentUser:t.data});var a=e.props.post;t.data.liked.includes(a.id)&&(e.setState({likeClass:"btn btn-success disabled"}),e.setState({dislikeClass:"btn btn-outline-dark disabled"})),t.data.disliked.includes(a.id)&&(e.setState({dislikeClass:"btn btn-danger disabled"}),e.setState({likeClass:"btn btn-outline-dark disabled"})),t.data.bookmarked.includes(a.id)&&(e.setState({bookmarkClass:"btn btn-info"}),e.setState({bookmarkDataTip:"remove from bookmarks"}))}))}},{key:"changeRating",value:function(e,t){var a=this.state,s=a.rating,r=a.currentUser,n=a.currentUserId,o={title:e.title,slug:e.slug,content:e.content,author:e.author,published:e.published},c=r.liked,l=r.disliked;1===t?(c.push(e.id),console.log(r.username+" liked "+e.title+" with id "+e.id)):(l.push(e.id),console.log(r.username+" disliked "+e.title+" with id "+e.id)),r.liked=c,r.dislike=l,r.liked.includes(e.id)&&(this.setState({likeClass:"btn btn-success disabled"}),this.setState({dislikeClass:"btn btn-outline-dark disabled"})),r.disliked.includes(e.id)&&(this.setState({dislikeClass:"btn btn-danger disabled"}),this.setState({likeClass:"btn btn-outline-dark disabled"})),U.put("user/list/"+n,r),this.setState({rating:s+t}),U.put("update-post/"+e.slug,Object(i.a)(Object(i.a)({},o),{},{rating:s+t})),window.location.replace("posts/"+e.slug)}},{key:"render",value:function(){var e=this,t=this.props,a=t.title,s=t.content,n=t.slug,o=t.author,c=t.image,i=t.postDate,l=t.day,d=t.dataType,u=t.post,h=t.getRatingSuffix,j=this.state,g=j.likeClass,p=j.dislikeClass,O=j.bookmarkClass,x=j.bookmarkDataTip,v=this.state.rating,k=this.state.users.filter((function(e){return e.username==localStorage.getItem("currentUser")}))[0];return Object(f.jsxs)("div",{className:this.context.darkMode?"blog-post text-light border bg-dark":"blog-post border",children:[Object(f.jsx)(w.a,{}),Object(f.jsx)("div",{className:"blog-post-img border",children:Object(f.jsx)("img",{src:c,alt:"Image for: "+a})}),Object(f.jsxs)("div",{className:"blog-post-info",children:[Object(f.jsxs)("div",{className:"blog-post-date",children:[Object(f.jsx)("span",{children:l}),Object(f.jsx)("span",{children:i})]}),Object(f.jsx)("div",{className:"blog-post-author",children:Object(f.jsx)(m.Consumer,{children:function(e){return Object(f.jsxs)(r.a.Fragment,{children:["by ",Object(f.jsx)("span",{children:e.getAuthor(o)})]})}})}),Object(f.jsx)("h1",{className:"blog-post-title",children:a}),Object(f.jsx)("p",{className:"blog-post-text",children:s.length>=500?s.substring(0,500)+"...":s}),Object(f.jsx)(b.b,{to:"posts/"+n,className:"blog-post-cta",children:"Read More"})]}),Object(f.jsxs)("div",{className:"blog-post-options",children:[Object(f.jsx)("div",{className:this.getRatingColor(v),children:Object(f.jsx)("span",{"data-tip":"rating: "+v.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),"data-type":d,children:h(v)})}),k?Object(f.jsx)(r.a.Fragment,{children:o===k.id?Object(f.jsx)("i",{className:"fas fa-info-circle"}):Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)(w.a,{}),Object(f.jsxs)("div",{className:"react",children:[Object(f.jsx)("div",{className:"upvote",children:Object(f.jsx)("button",{className:g,"data-tip":"like","data-type":d,onClick:function(){return e.changeRating(u,1)},children:Object(f.jsx)("i",{className:"far fa-thumbs-up"})})}),Object(f.jsx)("div",{className:"downvote",children:Object(f.jsx)("button",{className:p,"data-tip":"dislike","data-type":d,onClick:function(){return e.changeRating(u,-1)},children:Object(f.jsx)("i",{className:"far fa-thumbs-down"})})})]}),Object(f.jsxs)("div",{className:"other-react",children:[Object(f.jsx)("div",{className:"bookmark",children:Object(f.jsx)("button",{className:O,"data-tip":x,"data-type":d,onClick:function(){return e.addBookmark(u)},children:Object(f.jsx)("i",{className:"far fa-bookmark"})})}),Object(f.jsx)("div",{className:"comment","data-tip":"comment on this post","data-type":d,children:Object(f.jsx)("button",{className:"btn btn-dark",children:Object(f.jsx)("i",{style:{fontSize:".8rem"},className:"far fa-comment-alt"})})})]})]})}):""]})]},u.id)}}]),a}(s.Component);A.contextType=p;var F=function(e){var t=Object(s.useState)(!1),a=Object(v.a)(t,2),r=a[0],n=a[1],o=Object(s.useContext)(p);window.onscroll=function(){var t=e.showOn;document.body.scrollTop>t||document.documentElement.scrollTop>t?n(!0):(document.body.scrollTop<t||document.documentElement.scrollTop<t)&&n(!1)};var c=o.darkMode?"light":"dark";return r?Object(f.jsxs)("div",{className:"scroll-to-top",children:[Object(f.jsx)(w.a,{}),Object(f.jsx)("button",{"data-tip":"Scroll To Top","data-type":c,"data-place":"left",className:"btn btn-success",onClick:function(){return window.scrollTo(0,0)},children:Object(f.jsx)("i",{className:"fas fa-arrow-up"})})]}):""},T=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={offset:0,data:[],perPage:6,currentPage:0},e.renderTags=function(t){return t.map((function(t){return Object(f.jsx)("button",{onClick:function(){return e.props.getPostsByTag(t.id)},className:"badge "+t.styling,children:t.name},t.id)}))},e.reactToPost=function(e,t){console.log("reacted to "+e+" with "+t)},e.getRatingSuffix=function(e){if(e>999e6){var t=(e/1e9).toFixed(1);return"".concat(t,"B")}if(e>999999){var a=(e/1e6).toFixed(1);return"".concat(a,"M")}if(e>999){var s=(e/1e3).toFixed(1);return"".concat(s,"K")}if(e<-999999999){var r=(e/1e9).toFixed(1);return"".concat(r,"B")}if(e<-999999){var n=(e/1e6).toFixed(1);return"".concat(n,"M")}if(e<-999){var o=(e/1e3).toFixed(1);return"".concat(o,"K")}return e.toString()},e.handlePageClick=function(t){var a=t.selected,s=a*e.state.perPage;e.setState({currentPage:a,offset:s},(function(){return e.receivedData()})),window.scrollTo(0,0)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.props.posts&&this.receivedData()}},{key:"receivedData",value:function(){var e=this,t=this.props.posts,a=t.slice(this.state.offset,this.state.offset+this.state.perPage).map((function(t){var a=t.title,s=t.content,n=t.slug,o=t.author,c=t.image,i=t.rating,l=new Intl.DateTimeFormat("en-GB",{month:"long",year:"numeric",day:"numeric"}).format(new Date(t.published)),d=new Date(l).toLocaleString("en-us",{weekday:"long"});console.log(c);var u=e.context.darkMode?"light":"dark";return Object(f.jsx)(r.a.Fragment,{children:Object(f.jsx)(A,Object(k.a)({title:a,content:s,slug:n,author:o,image:c,rating:i,postDate:l,day:d,dataType:u,post:t,getRatingSuffix:e.getRatingSuffix},"dataType",u))},t.id)}));this.setState({pageCount:Math.ceil(t.length/this.state.perPage),postData:a})}},{key:"render",value:function(){var e=this,t=(this.props.posts,this.renderTags),a=(this.reactToPost,this.context.darkMode?" bg-dark page-link text-light":"page-link");return Object(f.jsx)(p.Consumer,{children:function(s){return Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsxs)("main",{className:s.darkMode?"bg-dark dark-page-shadow ":"bg-light border",children:[Object(f.jsx)("div",{className:"post-tags",children:t([{name:"latest",styling:"btn-primary",id:"Lat"},{name:"most popular",styling:"btn-success",id:"MPo"},{name:"least popular",styling:"btn-danger",id:"LPo"},{name:"oldest",styling:"btn-warning",id:"Old"}])}),Object(f.jsxs)("p",{className:s.darkMode?"sorted-by text-light":"sorted-by",children:["Sorted By:"," ",Object(f.jsxs)("span",{children:[Object(f.jsx)("i",{className:"fas fa-filter"})," ",e.props.curSorted]})]}),Object(f.jsx)("section",{className:s.darkMode?"posts-section-dark posts-section":"posts-section",children:e.state.postData})]})," ",Object(f.jsx)(N.a,{previousLabel:"previous",nextLabel:"next",breakLabel:"...",breakClassName:"break-me",pageCount:e.state.pageCount,marginPagesDisplayed:3,pageRangeDisplayed:5,onPageChange:e.handlePageClick,containerClassName:"pagination justify-content-center",pageClassName:"page-item",pageLinkClassName:a,previousClassName:a,nextClassName:a,activeClassName:"active"}),Object(f.jsx)(F,{showOn:2500})]})}})}}]),a}(s.Component);T.contextType=p;var _=a(47),L=a.n(_),R=["rows","isLoading"],J=function(e){var t=Object(s.useContext)(p);return function(a){var s,n=a.rows,o=a.isLoading,l=Object(c.a)(a,R);return o?Object(f.jsx)(r.a.Fragment,{children:(s=n,Object(f.jsx)("div",{style:{display:"block",width:"90%",margin:"0 auto 2rem"},className:t.darkMode?"post-dark-loader":"",children:Object(f.jsx)(L.a,{height:300,rows:s})}))}):Object(f.jsx)(e,Object(i.a)({},l))}},q=a(10),E=function(e){var t=e.toggleShowSearchBar,a=(Object(s.useContext)(p),Object(q.g)(),J(T)),r=Object(s.useState)("latest"),n=Object(v.a)(r,2),o=n[0],c=n[1],i=Object(s.useState)({loading:!1,posts:null}),l=Object(v.a)(i,2),d=l[0],u=l[1];Object(s.useEffect)((function(){t(!0),h()}),[u]);var h=function(){u({loading:!0}),U.get().then((function(e){return u({loading:!1,posts:e.data})}))},b=[];U.get().then((function(e){return b=e.data}));return Object(f.jsx)(a,{rows:3,getPostsByTag:function(e){if(d.posts){if("Lat"===e){var t=b.sort((function(e,t){return t.id-e.id}));u({posts:t}),c("latest")}if("Old"===e){var a=b.sort((function(e,t){return e.id-t.id}));u({posts:a}),c("oldest")}if("MPo"===e){var s=b.sort((function(e,t){return t.rating-e.rating}));u({posts:s}),c("most popular")}if("LPo"===e){var r=b.sort((function(e,t){return e.rating-t.rating}));u({posts:r}),c("least popular")}return"display posts by "+e}},isLoading:d.loading,posts:d.posts,curSorted:o})},G=a(48),Y=a(9),z=a.n(Y),H=function(e){var t=e.name,a=e.label,s=e.value,r=e.type,n=e.error,o=e.onChange;return Object(f.jsx)(p.Consumer,{children:function(e){return Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{className:e.darkMode?"text-light":"",htmlFor:t,children:a}),Object(f.jsx)("input",{className:e.darkMode?"form-control me-2 bg-dark text-light":"form-control me-2",value:s,onChange:o,id:t,type:r,name:t,placeholder:t}),n&&Object(f.jsx)("div",{className:"alert alert-danger",children:n})]})}})},V=["name","label","options","error"],W=function(e){var t=e.name,a=e.label,s=e.options,r=e.error,n=Object(c.a)(e,V);return Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{htmlFor:t,children:a}),Object(f.jsxs)("select",Object(i.a)(Object(i.a)({name:t,id:t},n),{},{className:"form-control",children:[Object(f.jsx)("option",{value:""}),s.map((function(e){return Object(f.jsx)("option",{value:e._id,children:e.name},e._id)}))]})),r&Object(f.jsx)("div",{className:"alert alert-danger",children:r})]})},K=function(e){var t=e.name,a=e.label,s=e.value,r=e.error,n=e.onChange,o=e.placeholder;return Object(f.jsx)(p.Consumer,{children:function(e){return Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{className:e.darkMode?"text-light":"",htmlFor:t,children:a}),Object(f.jsx)("textarea",{className:e.darkMode?"form-control me-2 bg-dark text-light":"form-control me-2",value:s,onChange:n,id:t,name:t,placeholder:o}),r&&Object(f.jsx)("div",{className:"alert alert-danger",children:r})]})}})},X=function(e){var t=e.name,a=e.label,s=e.value,r=e.type,n=e.error,o=e.onChange,c=e.accept;return Object(f.jsx)(p.Consumer,{children:function(e){return Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("label",{className:e.darkMode?"text-light":"",htmlFor:t,children:a}),Object(f.jsx)("input",{className:e.darkMode?"form-control me-2 bg-dark text-light":"form-control me-2",value:s,onChange:o,id:t,type:r,name:t,placeholder:t,accept:c}),n&&Object(f.jsx)("div",{className:"alert alert-danger",children:n})]})}})},Q=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{},errors:{}},e.chosenImg="",e.validate=function(){var t=z.a.validate(e.state.data,e.schema,{abortEarly:!1}).error;if(!t)return null;var a,s={},r=Object(G.a)(t.details);try{for(r.s();!(a=r.n()).done;){var n=a.value;s[n.path[0]]=n.message}}catch(o){r.e(o)}finally{r.f()}return s},e.validateProperty=function(t){var a=t.name,s=t.value,r=t.files;"image"===a&&(s=r[0].name);var n=Object(k.a)({},a,s),o=Object(k.a)({},a,e.schema[a]),c=z.a.validate(n,o).error;return c?c.details[0].message:null},e.handleSubmit=function(t){t.preventDefault();var a=e.validate();e.setState({errors:a||{}}),a||e.afterSubmit()},e.handleChange=function(t){var a=t.currentTarget,s=Object(i.a)({},e.state.errors),r=e.validateProperty(a);r?s[a.name]=r:delete s[a.name];var n=Object(i.a)({},e.state.data);"image"===a.name&&(e.chosenImg=a.files[0]),n[a.name]=a.value,e.setState({data:n,errors:s}),e.afterChange(a)},e}return Object(d.a)(a,[{key:"renderInput",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",s=this.state,r=s.data,n=s.errors;return Object(f.jsx)(H,{name:e,label:t,value:r[e],onChange:this.handleChange,error:n[e],type:a})}},{key:"renderTextArea",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,s=this.state,r=s.data,n=s.errors;return Object(f.jsx)(K,{name:e,label:t,value:r[e],onChange:this.handleChange,error:n[e],placeholder:a})}},{key:"renderSelect",value:function(e,t,a){var s=this.state,r=s.data,n=s.errors;return Object(f.jsx)(W,{name:e,value:r[e],label:t,options:a,onChange:this.handleChange,error:n[e]})}},{key:"renderImageField",value:function(e,t,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=this.state,n=r.data,o=r.errors;return Object(f.jsx)(X,{name:e,label:t,value:n[e],onChange:this.handleChange,error:o[e],placeholder:s,type:"file",accept:a})}},{key:"renderButton",value:function(e){return Object(f.jsx)("button",{disabled:this.validate(),className:"btn btn-warning",children:e})}}]),a}(s.Component),Z="http://localhost:8000/api/",$=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{email:"",password:"",username:""},errors:{}},e.schema={email:z.a.string().required().email().label("Email"),password:z.a.string().required().min(5).label("Password"),repeatPassword:Object(Y.ref)("password"),username:z.a.string().required().label("Username")},e.afterSubmit=function(){M.a.post(Z+"user/register/",{email:e.state.data.email,username:e.state.data.username,first_name:e.state.data.firstname,last_name:e.state.data.lastname,password:e.state.data.password}).then((function(e){window.location.reload(),window.location.replace("/")})).catch((function(t){var a=t.response.data.username?t.response.data.username[0]:"",s=Object(i.a)(Object(i.a)({},e.state.errors),{},{username:a});e.setState({errors:s})})),console.log("Registered!")},e.afterChange=function(e){},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.props.toggleShowSearchBar(!1)}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"form-container border "+"".concat(t.darkMode?"bg-dark text-light":"bg-light"),children:[Object(f.jsx)("h1",{children:"Register"}),Object(f.jsxs)("form",{action:"",onSubmit:e.handleSubmit,children:[e.renderInput("email","Email"),e.renderInput("username","Username"),e.renderInput("password","Password","password"),e.renderInput("repeatPassword","Repeat Password","password"),e.renderButton("Register")]}),Object(f.jsxs)("p",{children:["Already have an account? ",Object(f.jsx)(b.b,{to:"/login",children:"Login"})]})]})}})}}]),a}(Q),ee=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{username:"",password:""},errors:{}},e.schema={username:z.a.string().required().label("Username"),password:z.a.string().required().min(5).label("Password")},e.afterSubmit=function(){U.post(Z+"token/",{username:e.state.data.username,password:e.state.data.password}).then((function(t){localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),U.defaults.headers.Authorization="JWT "+localStorage.getItem("access_token"),e.context.onLogIn(e.state.data.username),localStorage.setItem("currentUser",e.state.data.username),e.props.history.replace("/dashboard")})).catch((function(t){console.log(t.response);var a=t.response.data.detail?"username or password incorrect":"",s={username:a,password:a};e.setState({errors:s})}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.context.onLogIn("Guest"),this.props.toggleShowSearchBar(!1)}},{key:"afterChange",value:function(e){}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"form-container border "+"".concat(t.darkMode?"bg-dark text-light":"bg-light"),children:[Object(f.jsx)("h1",{children:"Login"}),Object(f.jsxs)("form",{action:"",onSubmit:e.handleSubmit,children:[e.renderInput("username","Username"),e.renderInput("password","Password","password"),e.renderButton("Login")]}),Object(f.jsxs)("p",{children:["Don't have an account? ",Object(f.jsx)(b.b,{to:"/register",children:"Register"})]})]})}})}}]),a}(Q);ee.contextType=m;var te=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).performLogout=function(){var e=U.post("user/logout/blacklist/",{refresh:localStorage.getItem("refresh_token")});localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("currentUser"),U.defaults.headers.Authorization=null,console.log("logged out",e)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.props.toggleShowSearchBar(!1)}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"logout border "+"".concat(t.darkMode?"bg-dark text-light":"bg-light"),children:[Object(f.jsx)(m.Consumer,{children:function(e){return Object(f.jsxs)("p",{children:["Are you sure you want perform a logout for [",e.currentUser?localStorage.getItem("currentUser"):"Anonymous","] ?"]})}}),Object(f.jsxs)("div",{className:"logout-action-wrapper",children:[Object(f.jsx)(b.b,{className:t.darkMode?"btn btn-outline-light":"btn btn-outline-dark",to:"/dashboard",children:"No"}),Object(f.jsx)(b.b,{className:"btn btn-danger",to:"/login",onClick:function(){return e.performLogout()},children:"Yes"})]})]})}})}}]),a}(s.Component),ae=function(){var e=Object(s.useState)([]),t=Object(v.a)(e,2),a=t[0],n=t[1],o=Object(s.useContext)(p),c=Object(s.useContext)(m);return Object(s.useEffect)((function(){M.a.get(Z+"search/"+window.location.search).then((function(e){n(e.data),console.log(e.data)}))}),[n]),Object(f.jsx)(r.a.Fragment,{children:a.length?Object(f.jsx)("div",{className:o.darkMode?"posts-results-section dark-page-shadow text-light":"posts-results-section border",children:a.map((function(e){var t=e.title,a=e.id,s=e.author,r=e.published,n=e.content;return Object(f.jsxs)("div",{className:"post",children:[Object(f.jsx)(b.b,{to:"/posts/"+e.slug,children:Object(f.jsxs)("h3",{children:[" ",t]})}),Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{className:"author",children:s?c.getAuthor(e.author):"Anonymous"}),Object(f.jsxs)("p",{className:"date",children:[Object(f.jsx)("span",{className:"vertical-line",children:"|"}),new Intl.DateTimeFormat("en-GB",{dateStyle:"full"}).format(new Date(r))]})]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("p",{children:[n.substring(0,150)+"..."," ",Object(f.jsxs)(b.b,{to:"/posts/"+e.slug,children:[" ",Object(f.jsx)("i",{className:"fas fa-info-circle"})]})]})]},a)}))}):Object(f.jsx)("div",{className:+o.darkMode?"no-results dark-page-shadow text-light":"no-results border bg-light",children:Object(f.jsxs)("h3",{children:["No Results ",Object(f.jsx)("i",{class:"fas fa-folder-open"}),"!"]})})})},se=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(l.a)(this,s);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{title:"",image:"",content:""},errors:{},slugs:[],joi:""},e.schema={title:z.a.string().required().min(10).max(80).label("Title"),image:e.state.joi?e.state.joi.image().label("Image"):z.a.string().label("Image"),content:z.a.string().required().min(100).label("Content")},e.afterSubmit=function(){var t=e.state.data,a=t.title,s=t.content,r=new FormData;r.append("image",e.chosenImg,e.chosenImg.name),r.append("title",a),r.append("content",s),r.append("author",e.props.users.filter((function(e){return e.username==localStorage.getItem("currentUser")}))[0].id),U.post("create-post/",r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){e.props.history.replace("/dashboard"),console.log(t)})).catch((function(t){var a=t.response.data.title?t.response.data.title[0]:"",s=Object(i.a)(Object(i.a)({},e.state.errors),{},{title:a});e.setState({errors:s})}))},e}return Object(d.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.props.toggleShowSearchBar(!1),U.get().then((function(t){var a=t.data.map((function(e){return e.slug}));e.setState({slugs:a})}));var t=a(9),s=a(27),r=t.extend(s);this.setState({joi:r})}},{key:"afterChange",value:function(e){}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"form-container border "+"".concat(t.darkMode?"bg-dark":"bg-light"),children:[Object(f.jsx)("h1",{className:t.darkMode?"text-light":"",children:"Create A Post"}),Object(f.jsxs)("form",{action:"",onSubmit:e.handleSubmit,children:[e.renderInput("title","Title"),e.renderImageField("image","Image","image/*"),e.renderTextArea("content","Content"),e.renderButton("Post")]})]})}})}}]),s}(Q),re=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={searchValue:"",searchResults:[]},e.handleChange=function(t){t.preventDefault(),e.setState({searchValue:t.target.value}),""!==t.target.value&&U.get("search/?search="+t.target.value).then((function(t){e.setState({searchResults:t.data})}))},e.goSearch=function(t){t.preventDefault(),e.state.searchValue&&(e.props.history.push({pathname:"/search/",search:"?search= "+e.state.searchValue}),window.location.reload())},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.searchResults,s=t.searchValue;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsxs)("form",{className:"form-inline searchbar",onSubmit:e.goSearch,children:[Object(f.jsx)("input",{className:t.darkMode?"form-control bg-dark text-light":"form-control",type:"search",placeholder:"Search","aria-label":"Search",onChange:e.handleChange}),Object(f.jsx)("button",{className:"btn btn-outline-success",type:"submit",children:"Search"})]}),Object(f.jsx)("div",{style:{width:"90%",margin:"0rem auto"},children:Object(f.jsx)("ul",{className:"posts-results-on-change list-group list-group-flush dark-page-shadow",children:a&&s?a.map((function(e){return Object(f.jsxs)("li",{className:t.darkMode?"list-group-item bg-dark text-light":"list-group-item",children:[Object(f.jsx)("i",{className:"fas fa-search-plus"}),Object(f.jsx)("p",{children:e.title})]},e.id)})):""})})]})}})}}]),a}(s.Component),ne=Object(q.h)(re),oe=a(9),ce=a(27),ie=oe.extend(ce),le=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={showCommentForm:!1,data:{comment:""},errors:{},currentUserId:JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id},e.schema={comment:ie.string().max(1500).label("Comment")},e.toggleForm=function(){e.setState({showCommentForm:!e.state.showCommentForm})},e.afterSubmit=function(){e.setState({showCommentForm:!1});var t=e.props.addComment,a=e.state.data.comment;t({author:e.state.currentUserId,text:a}),e.setState({data:{comment:""}})},e}return Object(d.a)(a,[{key:"afterChange",value:function(e){}},{key:"render",value:function(){var e=this.state.showCommentForm;return Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsxs)("div",{className:"comments-header",children:[Object(f.jsx)("p",{children:"Comments Section"}),Object(f.jsx)("p",{children:Object(f.jsx)("button",{onClick:this.toggleForm,className:"btn btn-outline-primary",children:e?"close":Object(f.jsxs)(r.a.Fragment,{children:[" ",Object(f.jsx)("i",{className:"fas fa-plus"})," comment"]})})})]}),this.state.showCommentForm?Object(f.jsx)("div",{className:"comment-form",children:Object(f.jsxs)("form",{action:"",onSubmit:this.handleSubmit,children:[this.renderTextArea("comment","Comment"),this.renderButton("Submit")]})}):""]})}}]),a}(Q),de=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={currentUserId:JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id,postAuthorId:e.props.post.author,currentUser:{},comments:[]},e.renderUpDel=function(){var t=e.state,a=t.currentUserId,s=t.postAuthorId,r=t.currentUser,n=e.props.post.slug;return a!==s?r.is_superuser?(console.log("admin has right to delete post."),Object(f.jsxs)("div",{className:"actions",children:[Object(f.jsx)(b.b,{to:"/update-post/"+n,children:Object(f.jsx)("i",{className:"fas fa-wrench"})}),Object(f.jsx)(b.b,{to:"/delete-post/"+n,children:Object(f.jsx)("i",{className:"fas fa-trash-alt"})})]})):"":Object(f.jsxs)("div",{className:"actions",children:[Object(f.jsx)(b.b,{to:"/update-post/"+n,children:Object(f.jsx)("i",{className:"fas fa-wrench"})}),Object(f.jsx)(b.b,{to:"/delete-post/"+n,children:Object(f.jsx)("i",{className:"fas fa-trash-alt"})})]})},e.addComment=function(t){var a=e.state.comments,s=e.props.post,r=a;r.unshift(t),e.setState({comments:r}),U.post("comments/",Object(i.a)(Object(i.a)({},t),{},{post:s.id})).catch((function(e){return console.log(e.response)}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;U.get("user/list/"+this.state.currentUserId).then((function(t){return e.setState({currentUser:t.data})})),this.props.post&&U.get("comments/"+this.props.post.id).then((function(t){return e.setState({comments:t.data})}))}},{key:"render",value:function(){var e=this,t=this.props.post,a=t.title,s=t.image,n=t.author,o=t.content,c=t.published,i=this.state.comments;localStorage.getItem("access_token");return this.props.post?Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsx)(m.Consumer,{children:function(l){return Object(f.jsxs)("article",{className:t.darkMode?"post-container text-light":"post-container",children:[Object(f.jsx)(F,{showOn:700}),Object(f.jsxs)("div",{className:t.darkMode?"dark-page-shadow post-img-title":"post-img-title",children:[Object(f.jsx)("div",{className:"image-overlay",children:Object(f.jsx)("h1",{children:a})}),Object(f.jsx)("img",{src:s,className:"card-img-top",alt:"Image for: "+a})]}),Object(f.jsxs)("div",{className:t.darkMode?"post-body dark-page-shadow border bg-dark":"post-body border bg-light",children:[Object(f.jsxs)("span",{children:[Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:l.getAuthor(n)})," ",Object(f.jsx)("span",{children:" published on"})]}),Object(f.jsx)("p",{children:c?new Intl.DateTimeFormat("en-GB",{dateStyle:"full"}).format(new Date(c)):""})]}),Object(f.jsx)("hr",{}),Object(f.jsx)("div",{style:{whiteSpace:"pre-wrap"},className:t.darkMode?"post-content":"post-content text-dark",children:o}),Object(f.jsx)(r.a.Fragment,{children:e.renderUpDel()})]}),Object(f.jsxs)("div",{className:t.darkMode?"comments dark-page-shadow border bg-dark":"comments border bg-light",children:[Object(f.jsx)(le,{addComment:e.addComment}),Object(f.jsx)("section",{children:i.length?i.map((function(e,t){var a;return Object(f.jsxs)("div",(a={style:{whiteSpace:"pre-wrap"},className:"singular-comment dark-page-shadow"},Object(k.a)(a,"style",{boxShadow:"1px 3px 5px rgb(0 0 0 / 20%)"}),Object(k.a)(a,"children",[Object(f.jsxs)("div",{className:"comment-header",children:[n===e.author?Object(f.jsxs)("p",{children:[l.getAuthor(e.author)," ",Object(f.jsx)("i",{className:"fas fa-user-check"})]}):Object(f.jsx)("p",{children:l.getAuthor(e.author)}),Object(f.jsx)("p",{children:e.posted?new Intl.DateTimeFormat("en-GB",{dateStyle:"long",timeStyle:"short"}).format(new Date(e.posted)):""})]}),Object(f.jsx)("hr",{}),Object(f.jsx)("p",{children:e.text})]),a),t)})):Object(f.jsxs)("h4",{children:["No Comments ",Object(f.jsx)("i",{className:"fas fa-comment-dots"})]})})]})]})}})}}):""}}]),a}(s.Component),ue=function(e){var t=e.toggleShowSearchBar,a=e.match,n=Object(q.g)(),o=Object(s.useState)({postIsLoading:!1,post:{}}),c=Object(v.a)(o,2),i=c[0],l=c[1],d=J(de);return Object(s.useEffect)((function(){t(!0),l({postIsLoading:!0}),M.a.get(Z+"posts/"+a.params.slug).then((function(e){l({postIsLoading:!1,post:e.data})})).catch((function(e){console.log(e.response),404===e.response.status&&n.push("/*")}))}),[l]),Object(f.jsx)(r.a.Fragment,{children:Object(f.jsx)(d,{rows:1,isLoading:i.postIsLoading,post:i.post})})},he=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.props.toggleShowSearchBar(!1)}},{key:"render",value:function(){return Object(f.jsx)(p.Consumer,{children:function(e){return Object(f.jsx)("div",{className:e.darkMode?"container-404 bg-dark dark-page-shadow text-light":"container-404 border",children:Object(f.jsxs)("div",{className:"error-404",children:[Object(f.jsxs)("h1",{children:["4",Object(f.jsx)("i",{className:"fas fa-cog"}),"4!"]}),Object(f.jsx)("p",{children:"Sorry but, the content you are trying to access doesn't exist. We'll send you a link to go..."}),Object(f.jsxs)(b.b,{to:"/dashboard",children:[Object(f.jsx)("i",{className:"fas fa-hand-point-left"})," Back Home"]})]})})}})}}]),a}(s.Component),be=a(13),je=Object(be.a)({}),me=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(){var e;Object(l.a)(this,s);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{title:"",content:""},errors:{},slug:""},e.schema={title:z.a.string().required().min(10).max(80).label("Title"),image:z.a.any().meta({swaggerType:"file"}).optional().description("Image File"),content:z.a.string().required().min(100).label("Content")},e.afterSubmit=function(){var t=e.state.data,a=t.title,s=t.content,r=new FormData;e.chosenImg||(e.chosenImg=""),console.log(e.chosenImg);e.chosenImg&&e.chosenImg.name;r.append("image",e.chosenImg),r.append("title",a),r.append("slug",""),r.append("content",s),r.append("author",e.props.users.filter((function(e){return e.username==localStorage.getItem("currentUser")}))[0].id),U.put("update-post/"+e.props.match.params.slug,r).then((function(t){e.props.history.replace("/dashboard"),console.log(t)})).catch((function(e){return console.log(e.response)}))},e}return Object(d.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.props.toggleShowSearchBar(!1),U.get(Z+"posts/"+this.props.match.params.slug).then((function(t){var a=t.data,s=a.title,r=a.slug,n=a.content;e.setState({slug:r}),e.setState({data:{title:s,content:n}})})).catch((function(e){return console.log(e.response)}));var t=a(9),s=a(27),r=t.extend(s);this.setState({joi:r})}},{key:"afterChange",value:function(e){}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"form-container border "+"".concat(t.darkMode?"bg-dark":"bg-light"),children:[Object(f.jsx)("h1",{className:t.darkMode?"text-light":"",children:"Updating Your Post.."}),Object(f.jsxs)("form",{action:"",onSubmit:e.handleSubmit,children:[e.renderInput("title","Title"),e.renderImageField("image","Choose Image Again","image/*"),e.renderTextArea("content","Content"),Object(f.jsxs)("div",{className:"update-cancel-post-container",children:[e.renderButton("Update Post"),Object(f.jsx)(b.b,{onClick:je.goBack,className:"btn btn-primary",children:"Cancel"})]})]})]})}})}}]),s}(Q),ge=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={post:{},currentUserId:JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id,currentUser:{}},e.performDelete=function(){U.delete("delete-post/"+e.props.match.params.slug),e.props.history.replace("/dashboard"),window.location.reload()},e.renderYesBtn=function(){var t=e.state,a=t.post,s=t.currentUser;return t.currentUserId!==a.author?s.is_superuser?Object(f.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.performDelete()},children:"Yes"}):"":Object(f.jsx)("button",{className:"btn btn-danger",onClick:function(){return e.performDelete()},children:"Yes"})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.toggleShowSearchBar(!1),U.get("posts/"+this.props.match.params.slug).then((function(t){return e.setState({post:t.data})})),U.get("user/list/"+this.state.currentUserId).then((function(t){return e.setState({currentUser:t.data})}))}},{key:"render",value:function(){var e=this;return this.state.post.author===JSON.parse(atob(localStorage.getItem("refresh_token").split(".")[1])).user_id&&console.log("neeee mag niet!!!"),Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:"logout border "+"".concat(t.darkMode?"bg-dark text-light":"bg-light"),children:[Object(f.jsx)(m.Consumer,{children:function(t){return Object(f.jsxs)("p",{children:["Are you sure you want to delete your post: [",e.state.post.title,"]?"]})}}),Object(f.jsxs)("div",{className:"delete-post-action-wrapper",children:[Object(f.jsx)("button",{className:t.darkMode?"btn btn-outline-light":"btn btn-outline-dark",onClick:je.goBack,children:"No"}),e.renderYesBtn()]})]})}})}}]),a}(s.Component),pe=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={offset:0,data:[],perPage:8,currentPage:0},e.handlePageClick=function(t){var a=t.selected,s=a*e.state.perPage;e.setState({currentPage:a,offset:s},(function(){return e.getUserPosts()})),window.scrollTo(0,0)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.props.posts&&this.getUserPosts()}},{key:"getUserPosts",value:function(){var e=this.props.posts,t=e.slice(this.state.offset,this.state.offset+this.state.perPage).map((function(e){return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)("div",{className:t.darkMode?"user-post dark-page-shadow bg-dark":"user-post border bg-light",children:[Object(f.jsx)("div",{className:"title",children:Object(f.jsx)(b.b,{to:"/posts/"+e.slug,className:t.darkMode?"text-light":"text-dark",children:e.title.length>=20?e.title.substring(0,20)+"...":e.title})}),Object(f.jsx)("div",{className:"published",children:new Intl.DateTimeFormat("en-GB",{dateStyle:"full"}).format(new Date(e.published))}),Object(f.jsxs)("div",{className:"actions",children:[Object(f.jsx)(b.b,{to:"/update-post/"+e.slug,children:Object(f.jsx)("i",{className:"fas fa-wrench"})}),Object(f.jsx)(b.b,{to:"/delete-post/"+e.slug,children:Object(f.jsx)("i",{className:"fas fa-trash-alt"})})]})]},e.id)}},e.id)}));this.setState({pageCount:Math.ceil(e.length/this.state.perPage),postData:t})}},{key:"render",value:function(){var e=this;this.props.posts;return Object(f.jsx)(p.Consumer,{children:function(t){return Object(f.jsxs)(r.a.Fragment,{children:[e.state.postData,Object(f.jsx)(N.a,{previousLabel:"previous",nextLabel:"next",breakLabel:"...",breakClassName:"break-me",pageCount:e.state.pageCount,marginPagesDisplayed:3,pageRangeDisplayed:5,onPageChange:e.handlePageClick,containerClassName:"pagination justify-content-center",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:t.darkMode?" bg-dark page-link":"page-link",nextClassName:t.darkMode?" bg-dark page-link":"page-link",activeClassName:"active"})]})}})}}]),a}(s.Component),fe=function(e){var t=e.toggleShowSearchBar,a=(Object(s.useContext)(p),Object(q.g)(),J(pe)),r=Object(s.useState)({loading:!1,posts:null}),n=Object(v.a)(r,2),o=n[0],c=n[1],i=JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id;return Object(s.useEffect)((function(){t(!1),c({loading:!0}),U.get().then((function(e){c({loading:!1,posts:e.data.filter((function(e){return e.author===i}))})}))}),[c]),Object(f.jsx)(a,{rows:1,isLoading:o.loading,posts:o.posts})},Oe=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={data:{bio:""},errors:{},pageBio:"",bioChangeActive:!1},e.schema={bio:ie.string().min(10).max(300).label("Bio")},e.afterSubmit=function(){var t=e.state.data.bio,a=(e.state.pageBio,e.props.currentUser);e.setState({pageBio:t}),U.put("user/list/"+a.id,Object(i.a)(Object(i.a)({},a),{},{bio:t})),e.setState({bioChangeActive:!1})},e.editBio=function(){e.setState({bioChangeActive:!e.state.bioChangeActive})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.setState({pageBio:this.props.currentUser.bio}),this.setState({data:{bio:this.props.currentUser.bio}})}},{key:"afterChange",value:function(e){}},{key:"render",value:function(){var e=this.props,t=e.currentUser,a=e.darkCnxt,s=this.state,r=s.bioChangeActive,n=s.pageBio;return Object(f.jsxs)("div",{className:a.darkMode?"user-info dark-page-shadow bg-dark text-light":"user-info border bg-light",children:[Object(f.jsxs)("h4",{children:["Your profile: ",Object(f.jsx)("b",{children:localStorage.getItem("currentUser")})," "]}),Object(f.jsxs)("div",{className:"more-info",children:[Object(f.jsxs)("p",{children:["Joined on"," ",Object(f.jsx)("span",{children:t.date_joined?new Intl.DateTimeFormat("en-GB",{dateStyle:"full"}).format(new Date(t.date_joined)):""})]}),Object(f.jsx)("p",{children:t.email})]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{className:"bio",children:[Object(f.jsx)("p",{children:n}),Object(f.jsx)("button",{className:"btn btn-outline-info",onClick:this.editBio,children:r?"Close":"Edit Bio"}),r?Object(f.jsxs)("form",{action:"",onSubmit:this.handleSubmit,children:[this.renderTextArea("bio","Bio"),this.renderButton("submit")]}):""]})]})}}]),a}(Q),xe=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={currentUserId:JSON.parse(atob(localStorage.getItem("access_token").split(".")[1])).user_id,currentUser:{},posts:null,dataClasses:{data1:"data",data2:"data",data3:"data"}},e.renderPostById=function(t){if(e.state.posts)return e.state.posts.filter((function(e){return e.id===t}))[0].title},e.getPostSlug=function(t){if(!e.state.posts)return"";var a="posts/"+e.state.posts.filter((function(e){return e.id===t}))[0].slug;return a||""},e.toggleAccordion=function(t){var a=e.state.dataClasses;a[t]===t?a[t]="data":(a={data1:"data",data2:"data",data3:"data"})[t]=t,e.setState({dataClasses:a})},e.renderChevron=function(t){return e.state.dataClasses[t]===t?Object(f.jsx)("i",{className:"fas fa-chevron-up"}):Object(f.jsx)("i",{className:"fas fa-chevron-down"})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;U.get("user/list/"+this.state.currentUserId).then((function(t){return e.setState({currentUser:t.data})})),U.get().then((function(t){return e.setState({posts:t.data})}))}},{key:"render",value:function(){var e,t=this,a=this.state,s=a.currentUser,n=a.posts,o=a.dataClasses,c={};return n&&(e=n.filter((function(e){return e.author===t.state.currentUserId})),c=e.sort((function(e,t){return e.rating-t.rating}))[0]),Object(f.jsx)(p.Consumer,{children:function(a){return Object(f.jsxs)("div",{className:"dashboard",children:[s.id&&Object(f.jsx)(Oe,{darkCnxt:a,currentUser:s,topPost:c}),Object(f.jsxs)("div",{className:a.darkMode?"posts-reacted dark-page-shadow bg-dark text-light":"posts-reacted border bg-light",children:[Object(f.jsxs)("div",{className:"accordion",children:[Object(f.jsxs)("button",{className:"btn btn-dark",onClick:function(){return t.toggleAccordion("data1")},children:[Object(f.jsx)("span",{children:"posts liked"}),t.renderChevron("data1")]}),Object(f.jsx)("div",{className:o.data1,children:s.liked?Object(f.jsx)(r.a.Fragment,{children:s.liked.map((function(e,a){return Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-thumbs-up"})," ",Object(f.jsx)("span",{children:"|"}),Object(f.jsxs)(b.b,{to:t.getPostSlug(e),children:[" ",t.renderPostById(e)]})]},a)}))}):""})]}),Object(f.jsxs)("div",{className:"accordion",children:[Object(f.jsxs)("button",{className:"btn btn-dark",onClick:function(){return t.toggleAccordion("data2")},children:[Object(f.jsx)("span",{children:"posts disliked"}),t.renderChevron("data2")]}),Object(f.jsx)("div",{className:o.data2,children:s.disliked?Object(f.jsx)(r.a.Fragment,{children:s.disliked.map((function(e,a){return Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-thumbs-down"})," ",Object(f.jsx)("span",{children:"|"}),Object(f.jsxs)(b.b,{to:t.getPostSlug(e),children:[" ",t.renderPostById(e)]})]},a)}))}):""})]}),Object(f.jsxs)("div",{className:"accordion",children:[Object(f.jsxs)("button",{className:"btn btn-dark",onClick:function(){return t.toggleAccordion("data3")},children:[Object(f.jsx)("span",{children:"posts bookmarked"}),t.renderChevron("data3")]}),Object(f.jsx)("div",{className:o.data3,children:s.bookmarked?Object(f.jsx)(r.a.Fragment,{children:s.bookmarked.map((function(e,a){return Object(f.jsxs)("p",{children:[Object(f.jsx)("i",{className:"fas fa-bookmark"})," ",Object(f.jsx)("span",{children:"|"}),Object(f.jsxs)(b.b,{to:t.getPostSlug(e),children:[" ",t.renderPostById(e)]})]},a)}))}):""})]})]}),Object(f.jsxs)("div",{className:"user-posts",children:[Object(f.jsx)("div",{className:"manage-user-posts",children:Object(f.jsxs)(b.b,{to:"/create-post",children:["Post ",Object(f.jsx)("i",{className:"fas fa-plus-square"})," ",Object(f.jsx)("span",{children:"|"})]})}),Object(f.jsx)(fe,{toggleShowSearchBar:t.props.toggleShowSearchBar,userPosts:e})]})]})}})}}]),a}(s.Component),ve=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return Object(f.jsx)("div",{children:"adminpage"})}}]),a}(s.Component),ke=["component","toggleShowSearchBar","users"],Se=["component","toggleShowSearchBar","users"],Ne=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={currentUser:{name:""},users:[],darkMode:!1,showSearchBar:!0},e.handleLoggedIn=function(t){var a={name:t};e.setState({currentUser:a})},e.getAuthorById=function(t){if(t)return e.state.users.find((function(e){return e.id===t}))?e.state.users.find((function(e){return e.id===t})).username:"Anonymous"},e.toggleDarkMode=function(){e.setState({darkMode:!e.state.darkMode}),e.makePageDark()},e.toggleShowSearchBar=function(t){e.setState({showSearchBar:t})},e.makePageDark=function(){document.querySelector("html").className=e.state.darkMode?"":"dark-page-bg",document.querySelector("body").className=e.state.darkMode?"":"dark-page-bg"},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(U.defaults.headers.Authorization);var t=localStorage.getItem("refresh_token");"undefined"!==t&&null!==t||localStorage.removeItem("currentUser"),M.a.get(Z+"user/list/").then((function(t){return e.setState({users:t.data})})),(18.5<(new Date).getHours()||(new Date).getHours()<7)&&(console.log("Going Dark"),this.setState({darkMode:!0}),this.makePageDark())}},{key:"render",value:function(){var e=this;return Object(f.jsx)(p.Provider,{value:{darkMode:this.state.darkMode,toggleDarkMode:this.toggleDarkMode,background:"dark-bg"},children:Object(f.jsx)(m.Provider,{value:{currentUser:this.state.currentUser,onLogIn:this.handleLoggedIn,getAuthor:this.getAuthorById},children:Object(f.jsxs)(b.a,{children:[Object(f.jsx)(O,{}),this.state.showSearchBar?Object(f.jsx)(ne,{}):"",Object(f.jsxs)(q.d,{children:[Object(f.jsx)(ye,{path:"/admin",toggleShowSearchBar:this.toggleShowSearchBar,users:this.state.users,component:ve}),Object(f.jsx)(we,{path:"/search",component:ae}),Object(f.jsx)(we,{path:"/posts/:slug",toggleShowSearchBar:this.toggleShowSearchBar,component:ue}),Object(f.jsx)(we,{path:"/update-post/:slug",toggleShowSearchBar:this.toggleShowSearchBar,users:this.state.users,component:me}),Object(f.jsx)(we,{path:"/delete-post/:slug",toggleShowSearchBar:this.toggleShowSearchBar,users:this.state.users,component:ge}),Object(f.jsx)(we,{path:"/create-post",toggleShowSearchBar:this.toggleShowSearchBar,users:this.state.users,component:se}),Object(f.jsx)(q.b,{path:"/login",render:function(t){return Object(f.jsx)(ee,Object(i.a)({toggleShowSearchBar:e.toggleShowSearchBar},t))}}),Object(f.jsx)(q.b,{path:"/register",render:function(t){return Object(f.jsx)($,Object(i.a)({toggleShowSearchBar:e.toggleShowSearchBar},t))}}),Object(f.jsx)(we,{path:"/logout",toggleShowSearchBar:this.toggleShowSearchBar,component:te}),Object(f.jsx)(we,{exact:!0,path:"/dashboard",toggleShowSearchBar:this.toggleShowSearchBar,component:xe}),Object(f.jsx)(we,{exact:!0,path:"/",toggleShowSearchBar:this.toggleShowSearchBar,component:E}),Object(f.jsx)(q.b,{path:"*",children:Object(f.jsx)(he,{toggleShowSearchBar:this.toggleShowSearchBar})})]}),Object(f.jsx)(x,{})]})})})}}]),a}(s.Component),we=function(e){var t=e.component,a=e.toggleShowSearchBar,s=e.users,r=Object(c.a)(e,ke),n="undefined"!==localStorage.getItem("refresh_token")&&null!==localStorage.getItem("refresh_token");return Object(f.jsx)(q.b,Object(i.a)(Object(i.a)({},r),{},{render:function(e){return n?Object(f.jsx)(t,Object(i.a)(Object(i.a)({},e),{},{users:s,toggleShowSearchBar:a})):Object(f.jsx)(q.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},ye=function(e){var t=e.component,a=e.toggleShowSearchBar,s=e.users,r=Object(c.a)(e,Se),n="undefined"!==localStorage.getItem("refresh_token")&&null!==localStorage.getItem("refresh_token"),o=localStorage.getItem("access_token");if(!o)return Object(f.jsx)(q.a,{to:"/"});var l=JSON.parse(atob(o.split(".")[1])).user_id,d=s.filter((function(e){return e.id===l}))[0];return d?Object(f.jsx)(q.b,Object(i.a)(Object(i.a)({},r),{},{render:function(e){return n&&d.is_superuser?Object(f.jsx)(t,Object(i.a)(Object(i.a)({},e),{},{users:s,toggleShowSearchBar:a})):Object(f.jsx)(q.a,{to:{pathname:"/not-allowed",state:{from:e.location}}})}})):null},Ce=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,101)).then((function(t){var a=t.getCLS,s=t.getFID,r=t.getFCP,n=t.getLCP,o=t.getTTFB;a(e),s(e),r(e),n(e),o(e)}))};o.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(Ne,{})}),document.getElementById("root")),Ce()}},[[98,1,2]]]);
//# sourceMappingURL=main.ca3f046b.chunk.js.map