{"ast":null,"code":"import _objectSpread from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/kenny/Projects/DRF_React_YouPost/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import Form from\"../common/form\";import Joi,{ref}from\"joi-browser\";import React from\"react\";import apiURL from\"../../apiUrl\";import axiosInstance from\"axios\";import DarkContext from\"./../../context/darkMode\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RegisterForm=/*#__PURE__*/function(_Form){_inherits(RegisterForm,_Form);var _super=_createSuper(RegisterForm);function RegisterForm(){var _this;_classCallCheck(this,RegisterForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{email:\"\",password:\"\",username:\"\"/*firstname: \"\",\r\n      lastname: \"\",*/},errors:{}// joi: \"\",\n};_this.schema={email:Joi.string().required().email().label(\"Email\"),password:Joi.string().required().min(5).label(\"Password\"),repeatPassword:ref(\"password\"),username:Joi.string().required().label(\"Username\")/*firstname: Joi.string().required().label(\"Firstname\"),\r\n    lastname: Joi.string().required().label(\"Lastname\"),*/};_this.afterSubmit=function(){axiosInstance.post(apiURL+\"user/register/\",{email:_this.state.data.email,username:_this.state.data.username,first_name:_this.state.data.firstname,last_name:_this.state.data.lastname,password:_this.state.data.password}).then(function(res){window.location.reload();window.location.replace(\"/\");}).catch(function(res){var errorUsername=res.response.data.username?res.response.data.username[0]:\"\";var errors400=_objectSpread(_objectSpread({},_this.state.errors),{},{username:errorUsername});_this.setState({errors:errors400});});console.log(\"Registered!\");};_this.afterChange=function(input){};return _this;}_createClass(RegisterForm,[{key:\"componentDidMount\",value:function componentDidMount(){this.props.toggleShowSearchBar(false);// const BaseJoi = require(\"joi-browser\");\n// const ImageExtension = require(\"joi-image-extension\");\n// const Joi = BaseJoi.extend(ImageExtension);\n// this.setState({ joi: Joi });\n}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsx(DarkContext.Consumer,{children:function children(darkContext){return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container border \"+\"\".concat(darkContext.darkMode?\"bg-dark text-light\":\"bg-light\"),children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Register\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:_this2.handleSubmit,children:[_this2.renderInput(\"email\",\"Email\"),_this2.renderInput(\"username\",\"Username\"),_this2.renderInput(\"password\",\"Password\",\"password\"),_this2.renderInput(\"repeatPassword\",\"Repeat Password\",\"password\"),_this2.renderButton(\"Register\")]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Already have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})]})]});}});}}]);return RegisterForm;}(Form);export{RegisterForm as default};","map":{"version":3,"sources":["C:/Users/kenny/Projects/drf_react_youpost/src/components/actions/registerForm.jsx"],"names":["Form","Joi","ref","React","apiURL","axiosInstance","DarkContext","Link","RegisterForm","state","data","email","password","username","errors","schema","string","required","label","min","repeatPassword","afterSubmit","post","first_name","firstname","last_name","lastname","then","res","window","location","reload","replace","catch","errorUsername","response","errors400","setState","console","log","afterChange","input","props","toggleShowSearchBar","darkContext","darkMode","handleSubmit","renderInput","renderButton"],"mappings":"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","sourcesContent":["import Form from \"../common/form\";\r\nimport Joi, { ref } from \"joi-browser\";\r\nimport React from \"react\";\r\nimport apiURL from \"../../apiUrl\";\r\nimport axiosInstance from \"axios\";\r\nimport DarkContext from \"./../../context/darkMode\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport default class RegisterForm extends Form {\r\n  state = {\r\n    data: {\r\n      email: \"\",\r\n      password: \"\",\r\n      username: \"\",\r\n      /*firstname: \"\",\r\n      lastname: \"\",*/\r\n    },\r\n    errors: {},\r\n    // joi: \"\",\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.props.toggleShowSearchBar(false);\r\n\r\n    // const BaseJoi = require(\"joi-browser\");\r\n    // const ImageExtension = require(\"joi-image-extension\");\r\n\r\n    // const Joi = BaseJoi.extend(ImageExtension);\r\n    // this.setState({ joi: Joi });\r\n  }\r\n\r\n  schema = {\r\n    email: Joi.string().required().email().label(\"Email\"),\r\n    password: Joi.string().required().min(5).label(\"Password\"),\r\n    repeatPassword: ref(\"password\"),\r\n    username: Joi.string().required().label(\"Username\"),\r\n    /*firstname: Joi.string().required().label(\"Firstname\"),\r\n    lastname: Joi.string().required().label(\"Lastname\"),*/\r\n  };\r\n\r\n  afterSubmit = () => {\r\n    axiosInstance\r\n      .post(apiURL + \"user/register/\", {\r\n        email: this.state.data.email,\r\n        username: this.state.data.username,\r\n        first_name: this.state.data.firstname,\r\n        last_name: this.state.data.lastname,\r\n        password: this.state.data.password,\r\n      })\r\n      .then((res) => {\r\n        window.location.reload();\r\n        window.location.replace(\"/\");\r\n      })\r\n      .catch((res) => {\r\n        const errorUsername = res.response.data.username\r\n          ? res.response.data.username[0]\r\n          : \"\";\r\n\r\n        const errors400 = { ...this.state.errors, username: errorUsername };\r\n        this.setState({ errors: errors400 });\r\n      });\r\n\r\n    console.log(\"Registered!\");\r\n  };\r\n\r\n  afterChange = (input) => {};\r\n\r\n  render() {\r\n    return (\r\n      <DarkContext.Consumer>\r\n        {(darkContext) => (\r\n          <div\r\n            className={\r\n              \"form-container border \" +\r\n              `${darkContext.darkMode ? \"bg-dark text-light\" : \"bg-light\"}`\r\n            }\r\n          >\r\n            <h1>Register</h1>\r\n            <form action=\"\" onSubmit={this.handleSubmit}>\r\n              {this.renderInput(\"email\", \"Email\")}\r\n              {this.renderInput(\"username\", \"Username\")}\r\n              {/*  {this.renderInput(\"firstname\", \"Firstname\")}\r\n              {this.renderInput(\"lastname\", \"Lastname\")} */}\r\n              {this.renderInput(\"password\", \"Password\", \"password\")}\r\n              {this.renderInput(\r\n                \"repeatPassword\",\r\n                \"Repeat Password\",\r\n                \"password\"\r\n              )}\r\n              {this.renderButton(\"Register\")}\r\n            </form>\r\n            <p>\r\n              Already have an account? <Link to=\"/login\">Login</Link>\r\n            </p>\r\n          </div>\r\n        )}\r\n      </DarkContext.Consumer>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}